#!/bin/sh

#    ____    __
#   / __/__ / /___ _____
#  _\ \/ -_) __/ // / _ \
# /___/\__/\__/\_,_/ .__/
#                 /_/

# Add description here:
# > Hello World!
# > This is my setup script.


# Values
DOTS=$(cd -P -- "$(dirname -- "$0")" && pwd -P)

. "$DOTS/home/.config/env" # Get my environment variables

BAWKPACK_PATH="$DOTS/extra/bawkpack" # You can change bawkpack's path
BSYMLINK_PATH="$DOTS/extra/bsymlink" # You can also change bsymlink's path

STEPS="${@:-install before symlink after}"


# Functions
install_packages() {
	"$BAWKPACK_PATH" "$DOTS/packageslist"
}

symlink_dotfiles() {
	     "$BSYMLINK_PATH" "$DOTS/home" "$HOME"
	sudo "$BSYMLINK_PATH" "$DOTS/root" '/'
}

before_symlink() {
	# Create directories (to symlink files inside only, not the directory itself)
	mkdir "$HOME/.local/bin" "$HOME/.config/godot" "$HOME/.config/retroarch"

	# Delete files that may conflict when symlink dotfiles
	rm .bashrc
}

after_symlink() {
	# Change default shell
	chsh -s '/usr/bin/fish'

	# Enable firewall
	sudo ufw enable
}


# Start
for step in $STEPS; do
	case "$step" in
		'i'|'install') install_packages ;;
		'b'|'before')  before_symlink   ;;
		's'|'symlink') symlink_dotfiles ;;
		'a'|'after')   after_symlink    ;;
		*)             exit 1           ;;
	esac
done


exit 0
